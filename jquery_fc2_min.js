/*! jQuery FC2 Plugin - v0.1.3 - 2012-09-10
* http://fc2ist.blog.fc2.com/
* Copyright (c) 2012 @moi_fc2; Licensed MIT */
(function(a){var b,c,d,e;return a.fn.fc2=function(){function e(){var e;return e=this,{eyecatch:function(c){return e.each(function(){return new b(a(this),c)})},pager:function(b){return e.each(function(){return new d(a(this),b)})},lightbox:function(a){return new c(e,a),e}}}return e}(),a.fc2=function(){function a(){var a;return a=this,{scroll:function(b){return new e(b),a}}}return a}(),b=function(){function e(d,e){this.config=a.extend(c,e),this.target=d,b.apply(this)}var b,c,d;return c={className:"img-eyecatch",linkClassName:"link-eyecatch",enoData:"eno",titleData:"title",dataName:"eyecatch",fade:!1,fadeSpeed:300},d=/(^blog-entry-\d+\.html)|([&\?]?no=\d+)/,b=function(){var b,c,e,f,g,h,i,j,k;if(this.target.data(this.config.dataName+"_on"))return;this.target.data(this.config.dataName+"_on",this),i=this.target.find("[data-"+this.config.dataName+"]:eq(0)");if(!i.length)return;this.eyecatch=i.data(this.config.dataName).split("%%");if(this.eyecatch.length<1)return;return f=document.URL.substring(document.URL.lastIndexOf("/")+1),j=this.eyecatch.length<2||d.test(f)?this.eyecatch[0]:this.eyecatch[1],g=a("<img />").attr({src:j,"class":this.config.className}),this.config.fade&&g.css("opacity",0),e=this.target.data(this.config.enoData),k=this.target.data(this.config.titleData),b=i.data("class"),e!=null&&!d.test(f)?(c={href:"blog-entry-"+e+".html","class":this.config.linkClassName},k!=null&&(c.title=k),h=a("<a />").attr(c).append(g).prependTo(this.target),b&&h.addClass(b)):(b&&g.addClass(b),g.prependTo(this.target)),this.config.fade&&g.fadeTo(this.config.fadeSpeed,1),i.remove()},e}(),d=function(){function i(b,e){this.config=a.extend(d,e),this.target=b;if(this.target.data(this.config.dataName))return;this.target.data(this.config.dataName,this),this.info=a(window).data("pageinfo"),this.info||(this.info=f(this.target.data(this.config.currentData)),a(window).data("pageinfo",this.info));if(!this.info)return;c.apply(this)}var b,c,d,e,f,g,h;return d={range:10,totalData:"total",currentData:"current",dataName:"pagination",skip:!0,prev:"«",next:"»",className:null},g=/(^blog-entry-\d+\.html)|(^archives\.html)/,h=/(&?no=\d+)|(&?all[=&]?)|(&?mode=edit(&.*)?)|(&?editor[=&]?)/,f=function(a){var c,d,e,f,i,j,k,l,m;e={},f=document.URL.substring(document.URL.lastIndexOf("/")+1).split("#")[0],i=f.match(/\?(.+)/)?RegExp.$1:"",e.query=b(i),e.filename=f.split("?")[0],l=["q","tag","date","cat"];for(j=0,k=l.length;j<k;j++)c=l[j],e.query[c]&&(e.area=c,e.value=e.query[c]);if(g.test(e.filename)&&!e.area||h.test(i))return!1;if(e.area==null&&!e.filename)return{filename:"",query:{},area:"page",page:"0"};if(!e.area){d=e.filename.match(/(([^-]+)-)?([^-]+)-(\d+)(-(\d+))?\.html$/);if(d==null)return!1;d[3]!=null&&(e.prefix=d[2]),d[4]!=null&&(e.no=d[4]),e.area=(m=d[3])!=null?m:d[2],e.area==="page"&&delete e.no}return a!=null?e.page=a-0:e.page=1,e},b=function(a){var b,c,d,e,f,g;c={length:0},g=a.split("&");for(e=0,f=g.length;e<f;e++)d=g[e],b=d.split("="),b[0]!==""&&(c[b[0]]=b.length>1?b[1]:"",++c.length);return c},c=function(){var b,c,d,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u;s=(u=this.target.data(this.config.totalData)-0)!=null?u:1,p=this.config.range-0,b=this.info.page,s<1&&(s=1),b<1&&(b=1),p>s&&(p=s),d=Math.ceil(p/2),b-d<0?(j=1,i=p):b+d>=s?(j=s-p+1,i=s):(j=b-d+1,i=b+d),m=a("<ul />"),this.config.className!=null&&m.attr("class",this.config.className);for(g=t=j;j<=i?t<=i:t>=i;g=j<=i?++t:--t)h=a("<li>").appendTo(m),g===b?(h.addClass("active"),f="#"):f=e.apply(this,[g]),a("<a>").attr("href",f).text(g).appendTo(h);return this.config.skip&&(c=a('<li class="disabled"><a href="#">...</a></li>'),j>1&&(c.prependTo(m),r=a("<li>").prependTo(m),a("<a>").attr("href",e.apply(this,[1])).text("1").appendTo(r)),i<s&&(c.clone().appendTo(m),q=a("<li>").appendTo(m),a("<a>").attr("href",e.apply(this,[s])).text(s).appendTo(q))),n=a('<li class="prev" />'),k=a('<li class="next" />'),o=b>1?e.apply(this,[b-1]):"#",l=b<s?e.apply(this,[b+1]):"#",a("<a />").attr("href",o).text(this.config.prev).appendTo(n),a("<a />").attr("href",l).text(this.config.next).appendTo(k),o==="#"&&n.addClass("disabled"),l==="#"&&k.addClass("disabled"),m.prepend(n).append(k),this.target.append(m).on("click","a[href^=#]",function(a){return!1})},e=function(a){var b,c,d,e,f;if(!this.info.pattern)if(this.info.value!=null)this.info.pattern="/?"+this.info.area+"="+this.info.value+"&page={{page}}";else{b=[],f=[this.info.prefix,this.info.area,this.info.no,"{{page}}"];for(d=0,e=f.length;d<e;d++)c=f[d],c!=null&&c.length>=1&&b.push(c);this.info.pattern=b.join("-")+".html"}return this.info.pattern.replace("{{page}}",a-1)},i}(),e=function(){function c(b){b=typeof b=="function"?b(_defults.speed):void 0,a(document).on("click","a[href^=#]",function(c){var d,e,f;return c.preventDefault(),d=a(this).attr("href"),f=a(d==="#"?"html":d),f.length<1&&(f=a("html")),e=f.offset().top,a("html,body").animate({scrollTop:e},b,function(){if(d!=="#")return location.hash=d})})}var b;return b={speed:300},c}(),c=function(){function j(b,c){if(b.data("lightbox"))return;this.config=a.extend(g,c),this.target=b,d.apply(this)}var b,c,d,e,f,g,h,i;return g={opacity:.75},d=function(){var b;return b=this,f.apply(this),e.apply(this),this.target.data("lightbox",!0).on("click",function(d){return d.preventDefault(),c.apply(b,[a(this)])}).css("outline",0)},f=function(){return this.overlay=a("<div />").css({position:"fixed",top:0,left:0,opacity:this.config.opacity,"background-color":"black",width:"100%",height:"100%",display:"none",cursor:"pointer","z-index":1e3}).appendTo(a("body")).on("click",a.proxy(b,this))},e=function(){return this.box=a("<div />").css({position:"fixed",top:0,left:0,"background-color":"white",padding:"10px",display:"none","z-index":1001,"-webkit-border-radius":"6px","-moz-border-radius":"6px","-ms-border-radius":"6px","-o-border-radius":"6px","border-radius":"6px"}).appendTo(a("body"))},c=function(c){var d=this;return this.overlay.fadeIn(300),h(c.attr("href")).then(function(e){var f,g;return window.navigator.appVersion.toLowerCase().indexOf("msie 8.")!==-1&&d.box.width(e.width),f=a(e).css({"max-width":"100%",height:"auto",cursor:"pointer"}).on("click",a.proxy(b,d)),d.box.empty().append(e).fadeIn(300),g=c.attr("title"),g&&a('<div class="title" />').css({"padding-top":"10px"}).text(g).hide().appendTo(d.box).delay(300).slideDown(300),i.apply(d),d.box.css({top:"50%",left:"50%"}),a(window).on("resize",a.proxy(i,d))},function(){})},i=function(){i.i=i.i||0;if(i.i++%2)return;return this.box.css({"margin-left":-parseInt(this.box.outerWidth()/2),"margin-top":-parseInt(this.box.outerHeight()/2)})},b=function(){return this.overlay.fadeOut(200),this.box.fadeOut(200),a(window).off("resize",a.proxy(i,this))},h=function(b){var c;return c=new a.Deferred,a("<img />").on("load",function(){return c.resolve(this)}).attr("src",b),c.promise()},j}()})(jQuery);