/*! jQuery FC2 Plugin - v0.1.4 - 2012-09-11
* http://fc2ist.blog.fc2.com/
* Copyright (c) 2012 @moi_fc2; Licensed MIT */
(function(a){var b,c,d,e,f;return f={eyecatch:{className:"img-eyecatch",linkClassName:"link-eyecatch",enoData:"eno",titleData:"title",dataName:"eyecatch",fade:!1,fadeSpeed:300,carousel:"#index-carousel"},pager:{range:10,totalData:"total",currentData:"current",dataName:"pagination",skip:!0,prev:"«",next:"»",className:null},lightbox:{opacity:.75},scroll:{speed:300}},a.fn.fc2=function(){function e(){var e;return e=this,{eyecatch:function(c){var d;return d=a.extend(f.eyecatch,c),a(d.carousel).each(function(){var b;return b=a(".item",this),b.eq(0).addClass("active"),b.each(function(){var b,c,f,g,h;b=a(this),f=b.data("target"),c=e.filter('[data-eno="'+f+'"]');if(c.length)return;h=c.find("[data-"+d.dataName+"]:eq(0)");if(!h.length)return;g=h.data(d.dataName).split("%%");if(!g.length)return;return a("img."+d.className,b).attr("src",g.shift())})}).show().addClass("in"),e.each(function(){return new b(a(this),d)})},pager:function(b){var c;return c=a.extend(f.pager,b),e.each(function(){return new d(a(this),c)})},lightbox:function(b){var d;return d=a.extend(f.lightbox,b),new c(e,d),e}}}return e}(),a.fc2=function(){function b(){var b;return b=this,{scroll:function(c){var d;return d=a.extend(f.scroll,c),new e(d),b}}}return b}(),b=function(){function d(a,c){this.config=c,this.target=a,b.apply(this)}var b,c;return c=/(^blog-entry-\d+\.html)|([&\?]?no=\d+)/,b=function(){var b,d,e,f,g,h,i,j,k;if(this.target.data(this.config.dataName+"_on"))return;this.target.data(this.config.dataName+"_on",this),i=this.target.find("[data-"+this.config.dataName+"]:eq(0)");if(!i.length)return;this.eyecatch=i.data(this.config.dataName).split("%%");if(this.eyecatch.length<1)return;return f=document.URL.substring(document.URL.lastIndexOf("/")+1),j=this.eyecatch.length<2||c.test(f)?this.eyecatch[0]:this.eyecatch[1],g=a("<img />").attr({src:j,"class":this.config.className}),this.config.fade&&g.css("opacity",0),e=this.target.data(this.config.enoData),k=this.target.data(this.config.titleData),b=i.data("class"),e!=null&&!c.test(f)?(d={href:"blog-entry-"+e+".html","class":this.config.linkClassName},k!=null&&(d.title=k),h=a("<a />").attr(d).append(g).prependTo(this.target),b&&h.addClass(b)):(b&&g.addClass(b),g.prependTo(this.target)),this.config.fade&&g.fadeTo(this.config.fadeSpeed,1),i.remove()},d}(),d=function(){function h(b,d){this.config=d,this.target=b;if(this.target.data(this.config.dataName))return;this.target.data(this.config.dataName,this),this.info=a(window).data("pageinfo"),this.info||(this.info=e(this.target.data(this.config.currentData)),a(window).data("pageinfo",this.info));if(!this.info)return;c.apply(this)}var b,c,d,e,f,g;return f=/(^blog-entry-\d+\.html)|(^archives\.html)/,g=/(&?no=\d+)|(&?all[=&]?)|(&?mode=edit(&.*)?)|(&?editor[=&]?)/,e=function(a){var c,d,e,h,i,j,k,l,m;e={},h=document.URL.substring(document.URL.lastIndexOf("/")+1).split("#")[0],i=h.match(/\?(.+)/)?RegExp.$1:"",e.query=b(i),e.filename=h.split("?")[0],l=["q","tag","date","cat"];for(j=0,k=l.length;j<k;j++)c=l[j],e.query[c]&&(e.area=c,e.value=e.query[c]);if(f.test(e.filename)&&!e.area||g.test(i))return!1;if(e.area==null&&!e.filename)return{filename:"",query:{},area:"page",page:"0"};if(!e.area){d=e.filename.match(/(([^-]+)-)?([^-]+)-(\d+)(-(\d+))?\.html$/);if(d==null)return!1;d[3]!=null&&(e.prefix=d[2]),d[4]!=null&&(e.no=d[4]),e.area=(m=d[3])!=null?m:d[2],e.area==="page"&&delete e.no}return a!=null?e.page=a-0:e.page=1,e},b=function(a){var b,c,d,e,f,g;c={length:0},g=a.split("&");for(e=0,f=g.length;e<f;e++)d=g[e],b=d.split("="),b[0]!==""&&(c[b[0]]=b.length>1?b[1]:"",++c.length);return c},c=function(){var b,c,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u;s=(u=this.target.data(this.config.totalData)-0)!=null?u:1,p=this.config.range-0,b=this.info.page,s<1&&(s=1),b<1&&(b=1),p>s&&(p=s),e=Math.ceil(p/2),b-e<0?(j=1,i=p):b+e>=s?(j=s-p+1,i=s):(j=b-e+1,i=b+e),m=a("<ul />"),this.config.className!=null&&m.attr("class",this.config.className);for(g=t=j;j<=i?t<=i:t>=i;g=j<=i?++t:--t)h=a("<li>").appendTo(m),g===b?(h.addClass("active"),f="#"):f=d.apply(this,[g]),a("<a>").attr("href",f).text(g).appendTo(h);return this.config.skip&&(c=a('<li class="disabled"><a href="#">...</a></li>'),j>1&&(c.prependTo(m),r=a("<li>").prependTo(m),a("<a>").attr("href",d.apply(this,[1])).text("1").appendTo(r)),i<s&&(c.clone().appendTo(m),q=a("<li>").appendTo(m),a("<a>").attr("href",d.apply(this,[s])).text(s).appendTo(q))),n=a('<li class="prev" />'),k=a('<li class="next" />'),o=b>1?d.apply(this,[b-1]):"#",l=b<s?d.apply(this,[b+1]):"#",a("<a />").attr("href",o).text(this.config.prev).appendTo(n),a("<a />").attr("href",l).text(this.config.next).appendTo(k),o==="#"&&n.addClass("disabled"),l==="#"&&k.addClass("disabled"),m.prepend(n).append(k),this.target.append(m).on("click","a[href^=#]",function(a){return!1})},d=function(a){var b,c,d,e,f;if(!this.info.pattern)if(this.info.value!=null)this.info.pattern="/?"+this.info.area+"="+this.info.value+"&page={{page}}";else{b=[],f=[this.info.prefix,this.info.area,this.info.no,"{{page}}"];for(d=0,e=f.length;d<e;d++)c=f[d],c!=null&&c.length>=1&&b.push(c);this.info.pattern=b.join("-")+".html"}return this.info.pattern.replace("{{page}}",a-1)},h}(),e=function(){function b(b){var c;this.config=b,c=this.config.speed,a(document).on("click","a[href^=#]",function(b){var d,e,f;return b.preventDefault(),d=a(this).attr("href"),f=a(d==="#"?"html":d),f.length<1&&(f=a("html")),e=f.offset().top,a("html,body").animate({scrollTop:e},c,function(){if(d!=="#")return location.hash=d})})}return b}(),c=function(){function i(a,b){this.config=b;if(a.data("lightbox"))return;this.target=a,d.apply(this)}var b,c,d,e,f,g,h;return d=function(){var b;return b=this,f.apply(this),e.apply(this),this.target.data("lightbox",!0).on("click",function(d){return d.preventDefault(),c.apply(b,[a(this)])}).css("outline",0)},f=function(){return this.overlay=a("<div />").css({position:"fixed",top:0,left:0,opacity:this.config.opacity,"background-color":"black",width:"100%",height:"100%",display:"none",cursor:"pointer","z-index":1e3}).appendTo(a("body")).on("click",a.proxy(b,this))},e=function(){return this.box=a("<div />").css({position:"fixed",top:0,left:0,"background-color":"white",padding:"10px",display:"none","z-index":1001,"-webkit-border-radius":"6px","-moz-border-radius":"6px","-ms-border-radius":"6px","-o-border-radius":"6px","border-radius":"6px"}).appendTo(a("body"))},c=function(c){var d=this;return this.overlay.fadeIn(300),g(c.attr("href")).then(function(e){var f,g;return window.navigator.appVersion.toLowerCase().indexOf("msie 8.")!==-1&&d.box.width(e.width),f=a(e).css({"max-width":"100%",height:"auto",cursor:"pointer"}).on("click",a.proxy(b,d)),d.box.empty().append(e).fadeIn(300),g=c.attr("title"),g&&a('<div class="title" />').css({"padding-top":"10px"}).text(g).hide().appendTo(d.box).delay(300).slideDown(300),h.apply(d),d.box.css({top:"50%",left:"50%"}),a(window).on("resize",a.proxy(h,d))},function(){})},h=function(){h.i=h.i||0;if(h.i++%2)return;return this.box.css({"margin-left":-parseInt(this.box.outerWidth()/2),"margin-top":-parseInt(this.box.outerHeight()/2)})},b=function(){return this.overlay.fadeOut(200),this.box.fadeOut(200),a(window).off("resize",a.proxy(h,this))},g=function(b){var c;return c=new a.Deferred,a("<img />").on("load",function(){return c.resolve(this)}).attr("src",b),c.promise()},i}()})(jQuery);