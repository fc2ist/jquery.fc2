/*! jQuery FC2 Plugin - v0.1.2 - 2012-09-03
* http://fc2ist.blog.fc2.com/
* Copyright (c) 2012 @moi_fc2; Licensed MIT */
(function(){var a,b,c,d;$.fn.fc2=function(){function d(){var d;return d=this,{eyecatch:function(b){return d.each(function(){return new a($(this),b)})},pager:function(a){return d.each(function(){return new c($(this),a)})},lightbox:function(a){return new b(d,a),d}}}return d}(),$.fc2=function(){function a(){var a;return a=this,{scroll:function(b){return new d(b),a}}}return a}(),a=function(){function d(c,d){this.config=$.extend(b,d),this.target=c,a.apply(this)}var a,b,c;return b={className:"img-eyecatch",linkClassName:"link-eyecatch",enoData:"eno",titleData:"title",dataName:"eyecatch",fade:!1,fadeSpeed:300},c=/(^blog-entry-\d+\.html)|([&\?]?no=\d+)/,a=function(){var a,b,d,e,f,g,h;if(this.target.data(this.config.dataName+"_on"))return;this.target.data(this.config.dataName+"_on",this),f=this.target.find("[data-"+this.config.dataName+"]:eq(0)");if(!f.length)return;this.eyecatch=f.data(this.config.dataName).split("%%");if(this.eyecatch.length<1)return;return d=document.URL.substring(document.URL.lastIndexOf("/")+1),g=this.eyecatch.length<2||c.test(d)?this.eyecatch[0]:this.eyecatch[1],e=$("<img />").attr({src:g,"class":this.config.className}),this.config.fade&&e.css("opacity",0),b=this.target.data(this.config.enoData),h=this.target.data(this.config.titleData),b!=null&&!c.test(d)?(a={href:"blog-entry-"+b+".html","class":this.config.linkClassName},h!=null&&(a.title=h),$("<a />").attr(a).append(e).prependTo(this.target)):e.prependTo(this.target),this.config.fade&&e.fadeTo(this.config.fadeSpeed,1),f.remove()},d}(),c=function(){function h(a,d){this.config=$.extend(c,d),this.target=a;if(this.target.data(this.config.dataName))return;this.target.data(this.config.dataName,this),this.info=$(window).data("pageinfo"),this.info||(this.info=e(this.target.data(this.config.currentData)),$(window).data("pageinfo",this.info));if(!this.info)return;b.apply(this)}var a,b,c,d,e,f,g;return c={range:10,totalData:"total",currentData:"current",dataName:"pagination",skip:!0,prev:"«",next:"»",className:null},f=/(^blog-entry-\d+\.html)|(^archives\.html)/,g=/(&?no=\d+)|(&?all[=&]?)|(&?mode=edit(&.*)?)|(&?editor[=&]?)/,e=function(b){var c,d,e,h,i,j,k,l,m;e={},h=document.URL.substring(document.URL.lastIndexOf("/")+1).split("#")[0],i=h.match(/\?(.+)/)?RegExp.$1:"",e.query=a(i),e.filename=h.split("?")[0],l=["q","tag","date","cat"];for(j=0,k=l.length;j<k;j++)c=l[j],e.query[c]&&(e.area=c,e.value=e.query[c]);if(f.test(e.filename)&&!e.area||g.test(i))return!1;if(e.area==null&&!e.filename)return{filename:"",query:{},area:"page",page:"0"};if(!e.area){d=e.filename.match(/(([^-]+)-)?([^-]+)-(\d+)(-(\d+))?\.html$/);if(d==null)return!1;d[3]!=null&&(e.prefix=d[2]),d[4]!=null&&(e.no=d[4]),e.area=(m=d[3])!=null?m:d[2],e.area==="page"&&delete e.no}return b!=null?e.page=b-0:e.page=1,e},a=function(a){var b,c,d,e,f,g;c={length:0},g=a.split("&");for(e=0,f=g.length;e<f;e++)d=g[e],b=d.split("="),b[0]!==""&&(c[b[0]]=b.length>1?b[1]:"",++c.length);return c},b=function(){var a,b,c,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t;r=(t=this.target.data(this.config.totalData)-0)!=null?t:1,o=this.config.range-0,a=this.info.page,r<1&&(r=1),a<1&&(a=1),o>r&&(o=r),c=Math.ceil(o/2),a-c<0?(i=1,h=o):a+c>=r?(i=r-o+1,h=r):(i=a-c+1,h=a+c),l=$("<ol />"),this.config.className!=null&&l.attr("class",this.config.className);for(f=s=i;i<=h?s<=h:s>=h;f=i<=h?++s:--s)g=$("<li>").appendTo(l),f===a?(g.addClass("active"),e="#"):e=d.apply(this,[f]),$("<a>").attr("href",e).text(f).appendTo(g);return this.config.skip&&(b=$('<li class="disabled"><a href="#">...</a></li>'),i>1&&(b.prependTo(l),q=$("<li>").prependTo(l),$("<a>").attr("href",d.apply(this,[1])).text("1").appendTo(q)),h<r&&(b.clone().appendTo(l),p=$("<li>").appendTo(l),$("<a>").attr("href",d.apply(this,[r])).text(r).appendTo(p))),m=$('<li class="prev" />'),j=$('<li class="next" />'),n=a>1?d.apply(this,[a-1]):"#",k=a<r?d.apply(this,[a+1]):"#",$("<a />").attr("href",n).text(this.config.prev).appendTo(m),$("<a />").attr("href",k).text(this.config.next).appendTo(j),n==="#"&&m.addClass("disabled"),k==="#"&&j.addClass("disabled"),l.prepend(m).append(j),this.target.append(l).on("click","a[href^=#]",function(a){return!1})},d=function(a){var b,c,d,e,f;if(!this.info.pattern)if(this.info.value!=null)this.info.pattern="/?"+this.info.area+"="+this.info.value+"&page={{page}}";else{b=[],f=[this.info.prefix,this.info.area,this.info.no,"{{page}}"];for(d=0,e=f.length;d<e;d++)c=f[d],c!=null&&c.length>=1&&b.push(c);this.info.pattern=b.join("-")+".html"}return this.info.pattern.replace("{{page}}",a-1)},h}(),d=function(){function b(a){a=typeof a=="function"?a(_defults.speed):void 0,$(document).on("click","a[href^=#]",function(b){var c,d,e;return b.preventDefault(),c=$(this).attr("href"),e=$(c==="#"?"html":c),e.length<1&&(e=$("html")),d=e.offset().top,$("html,body").animate({scrollTop:d},a,function(){if(c!=="#")return location.hash=c})})}var a;return a={speed:300},b}(),b=function(){function i(a,b){if(a.data("lightbox"))return;this.config=$.extend(f,b),this.target=a,c.apply(this)}var a,b,c,d,e,f,g,h;return f={opacity:.75},c=function(){var a;return a=this,e.apply(this),d.apply(this),this.target.data("lightbox",!0).on("click",function(c){return c.preventDefault(),b.apply(a,[$(this)])}).css("outline",0)},e=function(){return this.overlay=$("<div />").css({position:"fixed",top:0,left:0,opacity:this.config.opacity,"background-color":"black",width:"100%",height:"100%",display:"none",cursor:"pointer","z-index":1e3}).appendTo($("body")).on("click",$.proxy(a,this))},d=function(){return this.box=$("<div />").css({position:"fixed",top:0,left:0,"background-color":"white",padding:"10px",display:"none","z-index":1001,"-webkit-border-radius":"6px","-moz-border-radius":"6px","-ms-border-radius":"6px","-o-border-radius":"6px","border-radius":"6px"}).appendTo($("body"))},b=function(b){var c=this;return this.overlay.fadeIn(300),g(b.attr("href")).then(function(d){var e,f;return window.navigator.appVersion.toLowerCase().indexOf("msie 8.")!==-1&&c.box.width(d.width),e=$(d).css({"max-width":"100%",height:"auto",cursor:"pointer"}).on("click",$.proxy(a,c)),c.box.empty().append(d).fadeIn(300),f=b.attr("title"),f&&$('<div class="title" />').css({"padding-top":"10px"}).text(f).hide().appendTo(c.box).delay(300).slideDown(300),h.apply(c),c.box.css({top:"50%",left:"50%"}),$(window).on("resize",$.proxy(h,c))},function(){})},h=function(){h.i=h.i||0;if(h.i++%2)return;return this.box.css({"margin-left":-parseInt(this.box.outerWidth()/2),"margin-top":-parseInt(this.box.outerHeight()/2)})},a=function(){return this.overlay.fadeOut(200),this.box.fadeOut(200),$(window).off("resize",$.proxy(h,this))},g=function(a){var b;return b=new $.Deferred,$("<img />").on("load",function(){return b.resolve(this)}).attr("src",a),b.promise()},i}()}).call(this);